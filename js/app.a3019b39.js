(function(e){function t(t){for(var o,i,s=t[0],d=t[1],l=t[2],h=0,u=[];h<s.length;h++)i=s[h],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&u.push(a[i][0]),a[i]=0;for(o in d)Object.prototype.hasOwnProperty.call(d,o)&&(e[o]=d[o]);c&&c(t);while(u.length)u.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,s=1;s<n.length;s++){var d=n[s];0!==a[d]&&(o=!1)}o&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},a={app:0},r=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/usdz-web-viewer/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],d=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var c=d;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"188d":function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);var o=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-main",[n("Home")],1)],1)},r=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"three-container",staticClass:"three-container"},[n("div",{staticClass:"three-overlay"},[null!=e.error?n("div",{staticClass:"mb-3",staticStyle:{color:"red"}},[e._v(" An error occured when loading the USDZ file. Maybe this file is not supported or the loader is not supported on this device. ")]):e._e(),n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"file",staticClass:"w-px h-px opacity-0 overflow-hidden absolute",attrs:{type:"file",multiple:"",name:"fields[assetsFieldHandle][]",accept:".usdz"}})]),n("v-dialog",{attrs:{width:"500"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"text-h5"},[e._v(" Information about the player ")]),n("v-card-text",{staticClass:"mt-2"},[e._v(" This player is based on the "),n("a",{attrs:{href:"https://www.npmjs.com/package/three-usdz-loader"}},[e._v("three-usdz-loader")]),e._v(" package"),n("br"),e._v(" Contact: contact@usdz-viewer.net ")]),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.dialog=!1}}},[e._v(" OK ")])],1)],1)],1)],1)},s=[],d=n("9ab4"),l=n("1b40"),c=n("5a89"),h=n("4721"),u=n("2132"),p=n("8769"),m=(n("d9e2"),n("8710"));function w(e){return new Promise((t,n)=>{console.log(e);const o=new m["a"];o.load(e,e=>{e instanceof c["w"]?t(e):n(new Error("Loaded object is not an instance of THREE.Group."))},void 0,e=>{n(e)})})}var f=n("34ad"),b=n("0ca5");function v(e){return new Promise((t,n)=>{const o=new b["a"];o.setDecoderPath("/examples/jsm/libs/draco/");const a=new f["a"];a.setDRACOLoader(o),a.load(e,(function(e){console.log("GLTF loaded successfully:",e),t(e.scene)}),(function(e){e.lengthComputable&&console.log(e.loaded/e.total*100+"% loaded")}),(function(e){console.error("An error happened",e),n(e)}))})}var g=n("21cb");function y(e){return new Promise((t,n)=>{const o=new g["a"];o.load(e,(function(e){e.computeVertexNormals();const n=new c["Z"]({color:40191,flatShading:!0}),o=new c["U"](e,n),a=new c["w"];a.add(o),t(a)}))})}var x=n("3191"),M=n.n(x);let C=class extends l["c"]{constructor(){super(...arguments),this.modelIsVisible=!1,this.modelIsLoading=!1,this.dialog=!1,this.loadedModels=[],this.error=null,this.loaderReady=null,this.modelUrl=null}async mounted(){this.modelUrl="http://localhost:8080/models/fbx/eve_j_gonzales.fbx";const e=this.getFileExtension(this.modelUrl);if(e)switch(e){case"usdz":this.usdz_loaders(this.modelUrl);break;default:this.default_loaders(this.modelUrl);break}else console.error("Invalid URL")}usdz_loaders(e){this.camera=new c["ib"](45,window.innerWidth/window.innerHeight,1,2e3),this.camera.position.set(0,50,350),this.scene=new c["rb"],this.scene.background=new c["i"](16777215);const t=new c["a"](1118481);t.intensity=1,this.scene.add(t);const n=new c["U"](new c["jb"](2e3,2e3),new c["V"]({color:16777215,depthWrite:!1}));n.rotation.x=Math.PI/2,n.receiveShadow=!0,this.scene.add(n);const o=new c["v"](2e3,20,0,0);o.material.opacity=.2,o.material.transparent=!0,this.scene.add(o),this.renderer=new c["Jb"]({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.toneMapping=c["g"],this.renderer.toneMappingExposure=2,this.renderer.shadowMap.enabled=!1,this.renderer.shadowMap.type=c["Eb"],new Promise(e=>{const t=new c["hb"](this.renderer);t.compileCubemapShader(),(new u["a"]).load("studio_country_hall_1k.hdr",n=>{const o=t.fromEquirectangular(n);n.mapping=c["o"],n.needsUpdate=!0,window.envMap=o.texture,e(!0)})}),this.threeContainer.appendChild(this.renderer.domElement),this.controls=new h["a"](this.camera,this.renderer.domElement),this.controls.update(),this.stats=new M.a,document.body.appendChild(this.stats.dom),this.ConvertUSDZFileFromURL(e),window.addEventListener("resize",this.onWindowResize),this.animate()}default_loaders(e){const t=document.createElement("div");document.body.appendChild(t),this.camera=new c["ib"](45,window.innerWidth/window.innerHeight,1,2e3),this.camera.position.set(0,50,350),this.scene=new c["rb"],this.scene.background=new c["i"](16777215);const n=new c["y"](16777215,4473924,5);n.position.set(0,200,0),this.scene.add(n);const o=new c["m"](16777215,5);o.position.set(0,200,100),o.castShadow=!0,o.shadow.camera.top=180,o.shadow.camera.bottom=-100,o.shadow.camera.left=-120,o.shadow.camera.right=120,this.scene.add(o);const a=new c["U"](new c["jb"](2e3,2e3),new c["V"]({color:16777215,depthWrite:!1}));a.rotation.x=Math.PI/2,a.receiveShadow=!0,this.scene.add(a);const r=new c["v"](2e3,20,0,0);r.material.opacity=.2,r.material.transparent=!0,this.scene.add(r),this.renderer=new c["Jb"]({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.toneMapping=c["g"],this.renderer.toneMappingExposure=2,this.renderer.shadowMap.enabled=!1,this.renderer.shadowMap.type=c["Eb"],new Promise(e=>{const t=new c["hb"](this.renderer);t.compileCubemapShader(),(new u["a"]).load("studio_country_hall_1k.hdr",n=>{const o=t.fromEquirectangular(n);n.mapping=c["o"],n.needsUpdate=!0,window.envMap=o.texture,e(!0)})}),this.threeContainer.appendChild(this.renderer.domElement),this.stats=new M.a,document.body.appendChild(this.stats.dom);const i=this.getFileExtension(e);if(i)switch(i){case"fbx":w(e).then(e=>{this.adjustCameraForDefaultLoadedModels(e),console.log(i+" model added to the scene.")}).catch(e=>{console.error("Error loading "+i+" model : ",e)});break;case"gltf":case"glb":v(e).then(e=>{this.adjustCameraForDefaultLoadedModels(e),console.log(i+" model added to the scene.")}).catch(e=>{console.error("Error loading "+i+" model : ",e)});break;case"ply":y(e).then(e=>{this.adjustCameraForDefaultLoadedModels(e),console.log(i+" model added to the scene.")}).catch(e=>{console.error("Error loading "+i+" model : ",e)});break;default:console.error("Unsupported file extension");break}else console.error("Invalid URL");window.addEventListener("resize",this.onWindowResize),this.animate()}getFileExtension(e){const t=e.match(/\.([a-zA-Z0-9]+)$/);return t?t[1].toLowerCase():null}onWindowResize(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}async animate(){this.stats.begin();const e=(new Date).getTime()/1e3;await new Promise(e=>setTimeout(e,10));for(const t of this.loadedModels)t.update(e);this.renderer.render(this.scene,this.camera),this.stats.end(),requestAnimationFrame(this.animate)}ConvertUSDZFileFromURL(e){fetch(e).then(e=>e.blob()).then(e=>{const t=new File([e],"AirfForce.usdz",{type:e.type}),n=new DataTransfer;n.items.add(t),this.fileInput&&(this.fileInput.files=n.files,this.loadUSDZFilesIntoScene(this.fileInput.files[0]))}).catch(e=>{console.error("Error loading default file:",e)})}async loadUSDZFilesIntoScene(e){if(this.modelIsLoading)return;this.modelIsLoading=!0,this.error=null;for(const a of this.loadedModels)a.clear();this.loadedModels=[];const t=new c["w"];this.scene.add(t);try{this.loader_usdz=new p["USDZLoader"]("/wasm");const n=await this.loader_usdz.loadFile(e,t);this.loadedModels.push(n)}catch(o){return this.error=o,console.error("An error occured when trying to load the model"+o),void(this.modelIsLoading=!1)}const n=this.loadedModels.map(e=>e.getGroup());this.adjustCameraForUSDZLoadedModels(this.camera,this.controls,n),this.modelIsLoading=!1,this.modelIsVisible=!0}adjustCameraForUSDZLoadedModels(e,t,n,o=1.5){const a=e,r=new c["Gb"],i=new c["Gb"],s=new c["d"];s.makeEmpty();for(const c of n)s.expandByObject(c);s.getSize(r),s.getCenter(i);const d=Math.max(r.x,r.y,r.z),l=d/(2*Math.atan(Math.PI*a.fov/360)),h=l/a.aspect,u=o*Math.max(l,h),p=t.target.clone().sub(a.position).normalize().multiplyScalar(u);t.maxDistance=10*u,t.target.copy(i),a.near=u/100,a.far=100*u,a.updateProjectionMatrix(),e.position.copy(t.target).sub(p),t.update()}adjustCameraForDefaultLoadedModels(e){const t=(new c["d"]).setFromObject(e),n=t.max.x-t.min.x,o=t.max.y-t.min.y,a=t.max.z-t.min.z,r=Math.max(n,o,a),i=r/Math.tan(Math.PI/180*22.5),s=1,d=5e3;this.camera=new c["ib"](45,window.innerWidth/window.innerHeight,s,d);const l=new c["Gb"];t.getCenter(l),this.camera.position.copy(l),this.camera.position.z+=i,this.camera.lookAt(l),this.controls=new h["a"](this.camera,this.renderer.domElement),this.controls.target.copy(l),this.controls.minDistance=100,this.controls.maxDistance=800,this.controls.update(),this.scene.add(e)}};Object(d["a"])([Object(l["b"])("three-container")],C.prototype,"threeContainer",void 0),Object(d["a"])([Object(l["b"])("file")],C.prototype,"fileInput",void 0),C=Object(d["a"])([l["a"]],C);var j=C,_=j,S=(n("cddc"),n("2877")),z=n("6544"),E=n.n(z),P=n("8336"),U=n("b0af"),F=n("99d9"),L=n("169a"),O=n("ce7e"),D=n("2fa4"),I=Object(S["a"])(_,i,s,!1,null,null,null),k=I.exports;E()(I,{VBtn:P["a"],VCard:U["a"],VCardActions:F["a"],VCardText:F["b"],VCardTitle:F["c"],VDialog:L["a"],VDivider:O["a"],VSpacer:D["a"]});var V=o["a"].extend({name:"App",components:{Home:k}}),R=V,W=n("7496"),A=n("f6c4"),H=Object(S["a"])(R,a,r,!1,null,null,null),T=H.exports;E()(H,{VApp:W["a"],VMain:A["a"]});var Z=n("f309");o["a"].use(Z["a"]);var G=new Z["a"]({});o["a"].config.productionTip=!1,new o["a"]({vuetify:G,render:e=>e(T)}).$mount("#app")},cddc:function(e,t,n){"use strict";n("188d")}});
//# sourceMappingURL=app.a3019b39.js.map